<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href=" img/apple-icon.png">
  <link rel="icon" type="image/png" href=" img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Admin Dashboard
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
  <!-- CSS Files -->
  <link href=" css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
  <link href=" css/paper-dashboard.css?v=2.0.0" rel="stylesheet" />
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href=" demo/demo.css" rel="stylesheet" />
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

</head>

<body class="">
  <div class="wrapper ">
      <div class="sidebar" data-color="white" data-active-color="danger">
          <!--
            Tip 1: You can change the color of the sidebar using: data-color="blue | green | orange | red | yellow"
        -->
          <div class="logo">
            <a href="http://www.creative-tim.com" class="simple-text logo-mini">
              <div class="logo-image-small">
                <img src=" img/priyanshi.jpg">
              </div>
            </a>
            <a href="/admin" class="simple-text logo-normal">
              Admin
              <!-- <div class="logo-image-big">
                <img src=" img/logo-big.png">
              </div> -->
            </a>
          </div>
          <div class="sidebar-wrapper">
            <ul class="nav">
              <li class="active">
                <a href="/admin">
                  <i class="nc-icon nc-cloud-upload-94"></i>
                  <p>Edit Transaction</p>
                </a>
              </li>
              <li>
                <a href="/signup" >
                  <i class="nc-icon nc-tap-01"></i>
                  <p>Open An Account</p>
                </a>
              </li>
              <li>
                <a href="/del">
                  <i class="nc-icon nc-single-02"></i>
                  <p>Close Account</p>
                </a>
              </li>
              <li>
            </ul>
          </div>
        </div>
    <div class="main-panel">
            <%- include nav.ejs %>
      <!-- <div class="panel-header panel-header-lg">
  <canvas id="bigDashboardChart"></canvas>


</div> -->
      <div class="content">
           <div class="col-lg-6 col-md-12 col-sm-12">
             <!--<div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-single-copy-04 text-warning"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers" >
                      <p class="card-category" >Total Balance</p>
                      <p class="card-title" id="num" > $00.00</p>
                        <p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                  <i class="fa fa-refresh"></i> Update Now
                </div>
              </div>
            </div>
          </div> -->
          <!-- <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-user-run text-success"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">Ongoing Projects</p>
                      <p class="card-title">
                        <p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                  <i class="fa fa-calendar-o"></i> Last day
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-support-17 text-danger"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">Bugs Identified</p>
                      <p class="card-title">
                        <p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                  <i class="fa fa-clock-o"></i> In the last hour
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-single-02 text-primary"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">Working teams</p>
                      <p class="card-title">
                        <p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                  <i class="fa fa-refresh"></i> Update now
                </div>
              </div>
            </div> 
          
        </div>-->

        <div class="row">
            <div class="col-md-12">
              <div class="card ">
                <div class="card-header ">
                  <h5 class="card-title">Show Transactions</h5>
                  <form>
                      <div class="col-md-5 pr-1">

                        <div class="input-group no-border">
                          <div class="row">
                            <label>Email</label>
                            <input type="text" id="email" class="form-control" placeholder="Account Email">
                          </div> 
                        </div>
                      </div>
                      <div class="col-md-5 pr-1">

                        <div class="input-group no-border">
                          <div class="row">
                            <label>Account Type</label>
                          <input type="text" id="account_type" class="form-control" placeholder="Account Type">
                          </div>
                        </div>
                      </div>
                      <button type="button" class="btn btn-primary" onclick="getTransactionHistory()">Submit</button>

                        <!-- <input type="text" id="email_input" class="form-control" placeholder="Customer ID"> -->
                      </div>
                  </form>
                </div>
              </div>
            </div>
        </div>

        <script>

        function getTransactionHistory() {
          $('#transaction-info').dataTable().fnDestroy();

          var email = document.getElementById("email").value
          var accountType = document.getElementById("account_type").value

          $('#transaction-info').dataTable({
            "ajax": {
              "url": `/transaction-info?acct_type=${accountType}&email=${email}`,
              "type": "GET",
            },
            "columns": [
              { "data": "transaction_timestamp" },
              { "data": "from_account_number",
                "render": function (data, type, row) {
                  console.log(data%10000);
                  data =data%10000;
              return data;
                }
              },
              {"data":"transaction_amt"},
              {"data":"frequency",
                "render": function (data, type, row) {
                if(data==null){
                  return "No";
                } else {
                  return data;
                }
              
                }}
            ]
          });
        }
          function getTransactions() {
            console.log("Button pressed!")
            var email = document.getElementById("email").value
            var accountType = document.getElementById("account_type").value
            console.log(email)

            axios.get(`/transaction-info?acct_type=${accountType}&email=${email}`)
            .then(response => {
              console.log(response)
            })
            .catch(err => {
              console.log(err);
            })

          } 

        </script>

        
        <div class="row">
            <div class="col-md-12">
              <div class="card ">
                <div class="card-header ">
                  <h5 class="card-title">Transaction History</h5>
                  <div class="container-fluid">
                    <div>
                      <table id="transaction-info" class="cell-border" style="width:100%">
                        <thead>
                          <tr>
  
                            <th>Transaction Time</th>
                            <th>Account Number</th>
                            <th>Transaction Amount</th>
                            <th>Is Recurring?</th>
                          </tr>
                        </thead>
                      </table>
                    </div>
                  </div>
                  <p class="card-category"></p>
                </div>
              </div>
            </div>
          </div>

          <div class="card ">
              <div class="card-header ">
                <h5 class="card-title">Issue Refund</h5>
                <div class="card-body">
                  <form action="javascript:void(0);" method="post" enctype="multipart/form-data">
                    <div class="row">
                      <div class="col-md-5 pr-1">
                        <div class="form-group">
                          <label >Amount</label>
                          <input type="text" class="form-control" placeholder="Amount" id="amount" name ="amount">
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-5 pr-1">
  
                        <div class="form-group">
                          <label>Account Number</label>
                          <input type="text" class="form-control" placeholder="Account Number" id="toAccount" name ="toAccount">
                        </div>
                      </div>
                    </div>
                  
                    
                    <div class="row">
                        <div class="col-md-5 pr-1">
                      <div class="update ml-auto mr-auto">
                        <button type="submit" class="btn btn-primary btn-round" onclick="submitTransaction();">Send Money</button>
                      </div>
                    </div>
                    </div>
                  </form>  
                <p class="card-category"></p>
              </div>
            </div>
          </div>

          <script>
            function submitTransaction() {
              var transaction = {};
              transaction.email = document.getElementById("email").value;
              transaction.amount = document.getElementById("amount").value;
              transaction.toAccount = "000000";
              transaction.toRoutingNum = "9876";
              transaction.transactionType="INTERNAL";
              transaction.type=document.getElementById("account_type").value;
              transaction.frequency="None";

              axios.post(`/transaction-money`, transaction)
              .then(response => {
                alert("Transaction updated successfully")
              })
              .catch(err => {
                console.log(err)
              })
            }
          </script>
  

      
          <!-- <div class="row">
            <div class="col-md-12">
              <div class="card ">
                <div class="card-header ">
                  <h5 class="card-title">Transaction Details</h5>
                  <p class="card-category"></p>
                </div>
                <div class="card-body ">
                  <table id="projects-table" class="cell-border" style="width:100%">
                    <thead>
                        <tr>
                          
                             <th>Project Name</th>
                          
                            <th>App Link</th>
         
                            <th>Documentation</th>
                            <th>Test Data</th>
                            <th>Test Cases</th> 

                        </tr>
                    </thead>
                    </table>
                </div>
                <div class="card-footer ">
                  <hr>
                  <div class="stats">
                    <i class="fa fa-history"></i> 
                  </div>
                </div>
              </div>
            </div>
          </div> -->

      </div>
      <%- include footer.ejs %>
  </div>
  <!--   Core JS Files   -->
  <script src=" js/core/jquery.min.js"></script>
  <script src=" js/core/popper.min.js"></script>
  <script src=" js/core/bootstrap.min.js"></script>
  <script src=" js/plugins/perfect-scrollbar.jquery.min.js"></script>
   <!-- Google Maps Plugin   
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script> -->
  <!-- Chart JS -->
  <script src=" js/plugins/chartjs.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src=" js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
  <script src=" js/paper-dashboard.min.js?v=2.0.0" type="text/javascript"></script>
  <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" type="text/javascript"></script>
  <!-- Paper Dashboard DEMO methods, don't include it in your project! -->
  <script src=" demo/demo.js"></script>
  
</body>

</html>
